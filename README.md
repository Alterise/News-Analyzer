# Система анализа и прогнозирования текстовых данных из новостеных источников

Этот репозиторий содержит комплексную систему для сбора финансовых новостей, обработки текстовых данных, генерации эмбеддингов и прогнозирования экономических показателей с использованием моделей машинного обучения.

## Основные возможности

### Данные
- Сбор новостей из Telegram с помощью Telethon
- Обработка и перевод текстов (русский -> английский)
- Генерация эмбеддингов с использованием BERT/SBERT
- Хранение в PostgreSQL с расширением pgvector

### Модели машинного обучения
- Прогнозирование временных рядов с LSTM
- Классификация экономических показателей с Gradient Boosting и Random Forest
- Комбинированные модели (новости + финансовые данные)
- Оптимизация гиперпараметров с Optuna

### Технологии
- Докеризированное окружение с поддержкой GPU
- PostgreSQL + pgvector для хранения эмбеддингов
- PyTorch и scikit-learn для моделирования
- HuggingFace Transformers для NLP

## Компоненты системы

### Сбор данных
- `scraper.py`: сборщик новостей из Telegram
- `en_ru_translation.py`: модуль перевода новостей

### Обработка эмбеддингов
- `embedding_model_bert.py`: обертка для BERT/SBERT
- `embedding_storage.py`: работа с базой данных
- `embedding_storager.py`: пакетная обработка

### Модели
- `main.py`: классификатор на Gradient Boosting
- `main_forest.py`: Random Forest с RNN-агрегацией
- `main_series.py`: прогнозирование временных рядов
- `with_time_series.py`: комбинированная LSTM-модель

### Инфраструктура
- Docker-образы для ML-моделей и PostgreSQL
- Скрипты инициализации БД

## Установка

1. Установите Docker и Docker Compose
2. Настройте переменные окружения в `.env`
3. Запустите `docker-compose up --build`

## Использование

Система может работать как целиком, так и отдельными компонентами:

- **Сбор новостей**: `python scraper.py`
- **Генерация эмбеддингов**: `python embedding_storager.py`
- **Обучение моделей**: `python main_forest.py` (или другие файлы моделей)

## Поток данных

```
Новости Telegram → PostgreSQL → Эмбеддинги → ML-модели → Прогнозы
```

## Требования

- Docker
- NVIDIA GPU (рекомендуется)
